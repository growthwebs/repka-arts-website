{% comment %}
  ========================================
  REPKA ARTS - SEO PRODUCT IMAGE
  Enhanced Product Image with SEO Alt Text
  UK English & SEO Best Practices
  ========================================
{% endcomment %}

{%- liquid
  comment
    Generate SEO-optimised alt text for product images
  endcomment
  assign seo_alt_text = ''
  assign image_title = ''
  
  if media.alt != blank
    assign seo_alt_text = media.alt
  else
    comment
      Generate alt text based on product type and media position
    endcomment
    if product.tags contains 'watercolor'
      assign art_type = 'watercolour painting'
    elsif product.tags contains 'oil'
      assign art_type = 'oil painting'
    elsif product.tags contains 'ceramic'
      assign art_type = 'ceramic art'
    elsif product.tags contains 'commission'
      assign art_type = 'custom art commission'
    elsif product.tags contains 'print'
      assign art_type = 'fine art print'
    else
      assign art_type = 'original artwork'
    endif
    
    comment
      Add media position if it's not the first image
    endcomment
    assign media_position = ''
    if media_position_number and media_position_number > 1
      assign media_position = ' - Image ' | append: media_position_number
    endif
    
    assign seo_alt_text = 'Original ' | append: art_type | append: ' by ' | append: shop.name | append: ' - ' | append: product.title | append: media_position
  endif
  
  comment
    Generate image title for better SEO
  endcomment
  if product.title != blank
    assign image_title = product.title | append: ' - Original Artwork by ' | append: shop.name
  endif
  
  comment
    Ensure alt text is not too long (125 characters max for SEO)
  endcomment
  if seo_alt_text.size > 125
    assign seo_alt_text = seo_alt_text | truncate: 122 | append: '...'
  endif
  
  comment
    Ensure title is not too long (60 characters max for SEO)
  endcomment
  if image_title.size > 60
    assign image_title = image_title | truncate: 57 | append: '...'
  endif
-%}

{% comment %} Enhanced Product Image with SEO Attributes {% endcomment %}
{% if media != blank %}
  {% assign image_height = height | default: media.height %}
  {% assign image_height_2x = height | default: image_height | times: 2 %}
  {% assign image_height_3x = height | default: image_height | times: 3 %}

  {% capture image_srcset -%}
    {{ media | image_url: height: image_height }} 1x, {{ media | image_url: height: image_height_2x }} 2x, {{ media | image_url: height: image_height_3x }} 3x
  {%- endcapture %}

  {% assign style_value = style | default: '' %}

  {% if unset_image_tag %}
    {% assign style_value = style_value | append: 'object-position: inherit;' %}
  {% endif %}

  {{ media | image_url: height: image_height | image_tag: class: class, srcset: image_srcset, style: style_value, alt: seo_alt_text, title: image_title }}
{% elsif text_fallback %}
  {{ text_fallback }}
{% endif %}
